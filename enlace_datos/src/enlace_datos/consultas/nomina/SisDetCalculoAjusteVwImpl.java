package enlace_datos.consultas.nomina;

import enlace_datos.consultas.nomina.common.SisDetCalculoAjusteVw;

import enlace_datos.util.utils_DB;

import oracle.jbo.JboException;
import oracle.jbo.NameValuePairs;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SisDetCalculoAjusteVwImpl extends ViewObjectImpl implements SisDetCalculoAjusteVw {
    /**This is the default constructor (do not remove)
     */
    public SisDetCalculoAjusteVwImpl() {
    }
    
    public void reset(){
       this.setWhereClause(" id_nomina=-1"); 
       this.executeQuery();
       this.setWhereClause("");
    }
    
    //Método que recalcula los descuentos por porcentaje de una nómina
    public void recalcularDescuentos(Number pIdNomina, String pUsuario){
        NameValuePairs vParametros;
        vParametros = new NameValuePairs();
        //System.out.println("El id nómina es: " + pIdNomina);
        //System.out.println("El usuario es: " + pUsuario);
        vParametros.setAttribute("1",pIdNomina);
        vParametros.setAttribute("2",pUsuario);
        if (!utils_DB.ejecutarProcedimiento(this.getDBTransaction(),"SIIF.SIS_PKG_CALCULOS.RECALCULAR_DESCUENTOS(?,?)", vParametros)){
            //System.out.println("Ha ocurrido un error.");
            throw new JboException("Ha ocurrido un error, por favor intente nuevamente", "01", null);
        } else {
            this.getDBTransaction().commit();
            //System.out.println("Se realizó el commit exitosamente.");
        }     
    }
}
