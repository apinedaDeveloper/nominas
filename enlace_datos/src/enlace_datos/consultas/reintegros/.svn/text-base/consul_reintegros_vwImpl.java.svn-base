package enlace_datos.consultas.reintegros;


import enlace_datos.util.utils;

import java.sql.ResultSet;

import oracle.jbo.domain.Date;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewObjectImpl;
import oracle.jbo.server.ViewRowImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class consul_reintegros_vwImpl extends ViewObjectImpl {
    /**This is the default constructor (do not remove)
     */
    public consul_reintegros_vwImpl() {
    }


    /**executeQueryForCollection - overridden for custom java data source support.
     */
    protected void executeQueryForCollection(Object qc, Object params[], int noUserParams) {super.executeQueryForCollection(qc, params, noUserParams);
    }

    /**hasNextForCollection - overridden for custom java data source support.
     */
    protected boolean hasNextForCollection(Object qc) {
        boolean bRet = super.hasNextForCollection(qc);
        return bRet;
    }

    /**createRowFromResultSet - overridden for custom java data source support.
     */
    protected ViewRowImpl createRowFromResultSet(Object qc, 
                                                 ResultSet resultSet) {
        ViewRowImpl value = super.createRowFromResultSet(qc, resultSet);
        return value;
    }

    /**getEstimatedRowCount - overridden for custom java data source support.
     */
    public long getEstimatedRowCount() {
        long value = super.getEstimatedRowCount();
        return value;
    }


    /**Gets the bind variable value for pUsuario
     */
    public String getpUsuario() {
        return (String)getNamedWhereClauseParam("pUsuario");
    }

    /**Sets <code>value</code> for bind variable pUsuario
     */
    public void setpUsuario(String value) {
        setNamedWhereClauseParam("pUsuario", value);
    }

    /**Gets the bind variable value for pStatusOrdenPago
     */
    public Number getpStatusOrdenPago() {
        return (Number)getNamedWhereClauseParam("pStatusOrdenPago");
    }

    /**Sets <code>value</code> for bind variable pStatusOrdenPago
     */
    public void setpStatusOrdenPago(Number value) {
        setNamedWhereClauseParam("pStatusOrdenPago", value);
    }
    
    public void busquedaPorFiltro(Date fechaInicio, Date fechaFin, String pUsuario, Number pStatusOrdenPago, String pCui, String pRegistroEmpleado) {
        String str_querry="";
        boolean condicionHabilitada = false;
        if (fechaInicio!= null && fechaFin != null) {
            str_querry = "fecha_creacion between to_date('"+utils.getFechaFormato(fechaInicio.getValue())+"','dd/MM/yyyy') and to_date('"+utils.getFechaFormato(fechaFin.getValue())+"','dd/MM/yyyy') + 1";  
            condicionHabilitada = true;
        } else if (fechaInicio!= null && fechaFin == null) {
            str_querry = "fecha_creacion between to_date('"+utils.getFechaFormato(fechaInicio.getValue())+"','dd/MM/yyyy') and sysdate + 1";
            condicionHabilitada = true;
        } else if (fechaInicio == null && fechaFin != null) {
            str_querry = "fecha_creacion <= to_date('"+utils.getFechaFormato(fechaFin.getValue())+"','dd/MM/yyyy') + 1";  
            condicionHabilitada = true;
        }
        if ( pCui != null && pCui.length() > 0 && pRegistroEmpleado != null && pRegistroEmpleado.length() > 0) {
            if ( condicionHabilitada == true ) {
                str_querry += " AND ( REGISTRO_EMPLEADO = " + pRegistroEmpleado + " or CUI = " + pCui + " ) ";
            } else {
                str_querry = " ( REGISTRO_EMPLEADO = " + pRegistroEmpleado + " or CUI = " + pCui + " ) ";
            }
        } else if ( pCui != null && pCui.length() > 0 ) {
            if ( condicionHabilitada == true ) {
                str_querry += " AND CUI like '" + pCui + "'";
            } else {
                str_querry = " CUI like '" + pCui + "'";
                //System.out.println("hola");
            }
        } else if ( pRegistroEmpleado != null && pRegistroEmpleado.length() > 0 ) {
            if ( condicionHabilitada == true ) {
                str_querry += " AND REGISTRO_EMPLEADO = " + pRegistroEmpleado;
            } else {
                str_querry = " REGISTRO_EMPLEADO = " + pRegistroEmpleado;
            }
        }
        this.setpUsuario(pUsuario);
        this.setpStatusOrdenPago(pStatusOrdenPago);
        this.setWhereClause(str_querry);
        //System.out.println(this.getWhereClause());
        this.executeQuery();
    }
}
