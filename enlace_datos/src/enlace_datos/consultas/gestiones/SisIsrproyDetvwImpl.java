package enlace_datos.consultas.gestiones;

import enlace_datos.consultas.gestiones.common.SisIsrproyDetvw;

import enlace_datos.util.utils_DB;

import oracle.jbo.JboException;
import oracle.jbo.NameValuePairs;
import oracle.jbo.Row;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SisIsrproyDetvwImpl extends ViewObjectImpl implements SisIsrproyDetvw {
    /**This is the default constructor (do not remove)
     */
    public SisIsrproyDetvwImpl() {
    }
    
    //Cambia el estado de la fila actual a FALSE o TRUE
    public void cambiarEstadoFilaActual(Boolean pValor){
       Row pFila;
       pFila=this.getCurrentRow();
       pFila.setAttribute("Seleccionado",pValor);  
    }

    //Cambia el estado a todas la filas del arreglo a FALSE o TRUE
    public void cambiarEstadoTodasFilas(Boolean pValor){
       Row []pFilas;
       int vTam; 
       pFilas=this.getAllRowsInRange();
       vTam=pFilas.length;
       for (int i=0;i<vTam;i++){
         pFilas[i].setAttribute("Seleccionado",pValor);  
       }
    }
    
    //Agrega un descuento al Detalle del Detalle de la planilla 031 y actualiza totales
    public void agregarDescuento(Number pIdPlanillaDet, Number pIdAjuste, Number pValor){
        //Object resultado = "CORRECTO";
        NameValuePairs vParametros;
        vParametros = new NameValuePairs();
        vParametros.setAttribute("1",pIdPlanillaDet);
        vParametros.setAttribute("2",pIdAjuste);
        vParametros.setAttribute("3",pValor);       
        /*if(pIdAjuste.equals("21") || pIdAjuste.equals("25")){
            resultado=utils_DB.getValorFuncion(this.getDBTransaction(),"sis_complementos_pkg.validaDescIGSS(?,?,?)",vParametros);
        }*/
        //if(resultado.equals("CORRECTO")){
            if (!utils_DB.ejecutarProcedimiento(this.getDBTransaction(),"sis_pkg_calculos.AgregarDescuentoPlanilla031(?,?,?)",vParametros)){
               throw new JboException("Ha ocurrido un error, por favor intente nuevamente","01",null);
                
            } else {
               this.getDBTransaction().commit();
            }
         //} else {
            //throw new JboException(resultado.toString());              
         //}                
    }
    
    //Actualiza el Total Descuentos y el Liquido a Recibir de una Detalle de Planilla 031
    public void actualizarTotales(Number pIdPlanillaDet){
        NameValuePairs vParametros;
        vParametros = new NameValuePairs();
        vParametros.setAttribute("1",pIdPlanillaDet);
        if (!utils_DB.ejecutarProcedimiento(this.getDBTransaction(),"sis_pkg_calculos.ActualizarInfoDetPlanilla031(?)",vParametros)){
            throw new JboException("Ha ocurrido un error, por favor intente nuevamente","01",null);    
        } else {
            this.getDBTransaction().commit();
        }                
    }
}
