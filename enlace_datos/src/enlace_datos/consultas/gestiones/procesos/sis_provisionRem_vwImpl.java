package enlace_datos.consultas.gestiones.procesos;

import enlace_datos.consultas.gestiones.procesos.common.sis_provisionRem_vw;

import enlace_datos.util.utils;
import enlace_datos.util.utils_DB;

import oracle.jbo.JboException;
import oracle.jbo.NameValuePairs;
import oracle.jbo.domain.Date;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class sis_provisionRem_vwImpl extends ViewObjectImpl implements sis_provisionRem_vw {
    /**This is the default constructor (do not remove)
     */
    public sis_provisionRem_vwImpl() {
    }

    /**Gets the bind variable value for pFechaI
     */
    public Date getpFechaI() {
        return (Date)getNamedWhereClauseParam("pFechaI");
    }

    /**Sets <code>value</code> for bind variable pFechaI
     */
    public void setpFechaI(Date value) {
        setNamedWhereClauseParam("pFechaI", value);
    }

    /**Gets the bind variable value for pFechaF
     */
    public Date getpFechaF() {
        return (Date)getNamedWhereClauseParam("pFechaF");
    }

    /**Sets <code>value</code> for bind variable pFechaF
     */
    public void setpFechaF(Date value) {
        setNamedWhereClauseParam("pFechaF", value);
    }
    public void generarPoliza(String pIdRemesa){
                
        NameValuePairs Parametros=new NameValuePairs();
        
        Parametros.setAttribute("1",utils.getNumberOracle(pIdRemesa)); 
        Parametros.setAttribute("2",utils.getAuthUser(this.getDBTransaction())); 
        String resultado =""; 
        resultado=utils_DB.ejecutarProcedimiento3(this.getDBTransaction(),"sis_pkg_procs.crear_provision_indemnizacion(?,?)",Parametros);
        
         if (!resultado.equals("OK")){
             throw new JboException(resultado); 
         }        
    }
    
    public void crear_poliza_contable(oracle.jbo.domain.Number pIdRemesa, oracle.jbo.domain.Number pNoPolizaConta){
       
       if (pIdRemesa==null || pNoPolizaConta==null){
        throw new JboException("Por favor ingrese el número de poliza contable");   
           
       }
       
       // invocar el metodo 
       // PROCEDURE GENERA_POLIZA_CONTA_PROVISION(pIdRemesa IN NUMBER, pPolizaContable IN NUMBER, pUsuario IN VARCHAR2);
       NameValuePairs Parametros=new NameValuePairs();
       String resultado = "OK";
        
//        System.out.println(pIdRemesa+"--"+pNoPolizaConta);
       Parametros.setAttribute("1",pIdRemesa);
       Parametros.setAttribute("2",pNoPolizaConta);
       Parametros.setAttribute("3",utils.getAuthUser(this.getDBTransaction()));       
        
           resultado = utils_DB.ejecutarProcedimiento3(this.getDBTransaction(),"sis_pkg_procs.GENERA_POLIZA_CONTA_PROVISION(?,?,?)",Parametros);
       if (resultado.compareToIgnoreCase("OK")!=0){
           int posIni=resultado.indexOf("<<");
           int posFin=resultado.indexOf(">>");
           if(posIni > 0 && posFin > 0){
               resultado=resultado.substring(posIni+2, posFin);
           }
           throw new JboException(resultado);
       }        
        
    }
}
