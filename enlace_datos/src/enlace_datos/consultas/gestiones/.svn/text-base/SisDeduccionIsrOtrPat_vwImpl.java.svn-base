package enlace_datos.consultas.gestiones;

import enlace_datos.consultas.gestiones.common.SisDeduccionIsrOtrPat_vw;

import enlace_datos.consultas.gestiones.empleado.SisEmpleadoVwRowImpl;

import enlace_datos.util.utils;
import enlace_datos.util.utils_DB;

import oracle.jbo.JboException;
import oracle.jbo.NameValuePairs;
import oracle.jbo.Row;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SisDeduccionIsrOtrPat_vwImpl extends ViewObjectImpl implements SisDeduccionIsrOtrPat_vw {
    /**This is the default constructor (do not remove)
     */
    public SisDeduccionIsrOtrPat_vwImpl() {
    }

    /**Gets the bind variable value for pRegPer
     */
    public Number getpRegPer() {
        return (Number)getNamedWhereClauseParam("pRegPer");
    }

    /**Sets <code>value</code> for bind variable pRegPer
     */
    public void setpRegPer(Number value) {
        setNamedWhereClauseParam("pRegPer", value);
    }

    /**Gets the bind variable value for pAnio
     */
    public Number getpAnio() {
        return (Number)getNamedWhereClauseParam("pAnio");
    }

    /**Sets <code>value</code> for bind variable pAnio
     */
    public void setpAnio(Number value) {
        setNamedWhereClauseParam("pAnio", value);
    }
    
    public void agregar_Detalle(Number pRegistroEmpleado,Number pTipoDeduccion,Number pAnio,String pUsuario){
        
       Row vFila;
       
       vFila=this.createRow();
       vFila.setAttribute("RegistroEmpleado",pRegistroEmpleado);
       vFila.setAttribute("Anio",pAnio);
       vFila.setAttribute("IdTipoDeduccionIsr",pTipoDeduccion);
       vFila.setAttribute("Cantidad",0);
       vFila.setAttribute("CreadoPor",pUsuario);
       
       this.insertRow(vFila);
       
        
    }


    /**Gets the bind variable value for pTipo
     */
    public Number getpTipo() {
        return (Number)getNamedWhereClauseParam("pTipo");
    }

    /**Sets <code>value</code> for bind variable pTipo
     */
    public void setpTipo(Number value) {
        setNamedWhereClauseParam("pTipo", value);
    }
    
    public void CongelarFormularioSAT(Number pRegistroEmpleado,Number pAnio, Number tipoCalculo, String pUsuario){
        
       int vResul; 
        String strQuery ;
        
       if (tipoCalculo == null){
           strQuery = "update sis_deduccion_isr set tipo_calculo = -1, mod_por= "+ pUsuario
           + " where registro_empleado = "+pRegistroEmpleado +" and id_tipo_deduccion_isr = 17 and anio = "+pAnio;
       }else {
           strQuery = "update sis_deduccion_isr set tipo_calculo = null, mod_por= "+ pUsuario
           + " where registro_empleado = "+pRegistroEmpleado +" and id_tipo_deduccion_isr = 17 and anio = "+pAnio;
       }
       
        System.out.println(strQuery+" - "+ tipoCalculo);
       vResul=utils_DB.getEjecutarConsulta(this.getDBTransaction(), strQuery);

       if (vResul>0)
       {
         System.out.println("Formulario Congelado exitosamente.");
         
       }else
       {
         this.getDBTransaction().rollback();
         new JboException("Ha ocurrido un error al momenot de congelar el formulario.");   
           
       }
       
       
       
    }
}
