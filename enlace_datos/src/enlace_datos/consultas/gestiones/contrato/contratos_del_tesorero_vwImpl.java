package enlace_datos.consultas.gestiones.contrato;


import enlace_datos.consultas.gestiones.contrato.common.contratos_del_tesorero_vw;

import enlace_datos.util.utils;
import enlace_datos.util.utils_DB;

import oracle.jbo.NameValuePairs;
import oracle.jbo.Row;
import oracle.jbo.server.ViewObjectImpl;
import oracle.jbo.domain.Number;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class contratos_del_tesorero_vwImpl extends ViewObjectImpl implements contratos_del_tesorero_vw {
    /**This is the default constructor (do not remove)
     */
public contratos_del_tesorero_vwImpl() {


}

    /**Gets the bind variable value for pUsuario
     */
public String getpUsuario() {
        return (String)getNamedWhereClauseParam("pUsuario");
}

    /**Sets <code>value</code> for bind variable pUsuario
     */
public void setpUsuario(String value) {
        setNamedWhereClauseParam("pUsuario", value);
}
    
    
public void filtrarXRegistro(String pUsuario,Number pRegistroEmpleado){
        this.setpUsuario(pUsuario);
        this.setWhereClause("registro_empleado="+pRegistroEmpleado);
        this.executeQuery();
}
    
public void filtrarSinfiltros(String pUsuario){
        this.setpUsuario(pUsuario);
        this.setWhereClause("");
        this.executeQuery();
}


public void filtrarXEstado(String pUsuario,Number pEstado){
        this.setpUsuario(pUsuario);
        
        if (pEstado.equals(new Number(0))){
            
            this.setWhereClause("");
            
        }else{
        
            this.setWhereClause("estatus="+pEstado);
            
        }
        
        
        this.executeQuery();
}


public void CambiarEstadoSel(Boolean vValor){
   Row[] vFilas;     
   vFilas=this.getAllRowsInRange();
   int vTamanio=vFilas.length;
        
   for (int i=0;i<vTamanio;i++){
       
       vFilas[i].setAttribute("Seleccionado",vValor);
       
   }      
}


public void SeleccionarTodos(){

    CambiarEstadoSel(true);
        
}

public void DesSeleccionarTodos(){

    CambiarEstadoSel(false);
            
}


public void trasladarRRHH(){
    
    cambiarEstadoGestion(new Number(29));
   // System.out.println("debug rrhh" ); 
}

public void cambiarEstadoGestion(Number pEstado){
    NameValuePairs vPara= new NameValuePairs();
    Object vValorFuncion;
    String sqlQuerry;
    Number vIdContrato;
    Object vSeleccionado;
    Object vEStadoCorrecto;
    
    Row[] vFilas;     
    vFilas=this.getAllRowsInRange();
    int vTamanio=vFilas.length;
         
    for (int i=0;i<vTamanio;i++){
        
      vSeleccionado=vFilas[i].getAttribute("Seleccionado");
        
      if (vSeleccionado!=null)
      {
      
        if (vSeleccionado.toString().equals("true"))
        {
            
            vIdContrato=(Number)vFilas[i].getAttribute("IdContrato");
            
            vEStadoCorrecto=utils_DB.getEjecutarQuerry(this.getDBTransaction(),"select  count(0) from sis_contrato where id_contrato=" +vIdContrato +" and estatus=3");  
            
            if (vEStadoCorrecto!=null && vEStadoCorrecto.toString().equals("1")) 
            {
                vPara.setAttribute("1",utils.getAuthUser(this.getDBTransaction()));
                vPara.setAttribute("2",vIdContrato);
                vPara.setAttribute("3",pEstado.intValue());
                vPara.setAttribute("4","NOMBRAMIENTO");
                vPara.setAttribute("5","SI");
                
                    
                // sqlQuerry="select max(id_autorizacion) from sis_autorizacion where id_solicitud="+pIdGestion;
                
                sqlQuerry="select sis_autorizacion_sq.currval from dual";

                vValorFuncion=utils_DB.getValorFuncion2(this.getDBTransaction(),"sis_pkg_util.getNumeroAutorizacion(?,?,?,?,?)",vPara,sqlQuerry);
                  
               // System.out.println("debug " + vIdContrato);    
                                                
            }
                        
        }
        this.getDBTransaction().commit();
        //  vIdContrato=" ";
      
          
      }
        
        
    }      
    
    
}

    
}
