package enlace_datos.consultas.complementos;


import enlace_datos.consultas.complementos.common.SisComplementoIgssVw;

import java.util.Calendar;

import oracle.jbo.Row;
import oracle.jbo.ViewObject;
import oracle.jbo.server.SessionImpl;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SisComplementoIgssVwImpl extends ViewObjectImpl implements SisComplementoIgssVw {
    /**This is the default constructor (do not remove)
     */
    public SisComplementoIgssVwImpl() {
    }
    
    
    public void cambiarEstadoActual(Boolean pValor){
        
        
       Row pFila;
       pFila=this.getCurrentRow();
       pFila.setAttribute("isSel",pValor);  
       
                
    }


    public void cambiarEstadoTodos(Boolean pValor){
        
       Row []pFilas;
       int vTam; 
       pFilas=this.getAllRowsInRange();
        
       vTam=pFilas.length;
       
       for (int i=0;i<vTam;i++){
         
         pFilas[i].setAttribute("isSel",pValor);  
           
       }
                
    }
    
    /**
     *  Metodo que recorre la view de SisComplementoDetVw y se posiciona en
     *  el row asociado al current_row de la view SisComplementoIgssView1
     */
     public void ubicarEnFilaAsociadaCompleDet(){
         Row pFila;
         ViewObject viewDet;
         
         pFila = this.getCurrentRow();
         viewDet = this.getDBTransaction().getRootApplicationModule().findViewObject("SisComplementoDetVw");
         viewDet.setWhereClause("id_contrato="+pFila.getAttribute("IdContrato").toString()+" and registro_empleado="+pFila.getAttribute("RegistroEmpleado").toString()+" and id_complemento_igss = "+pFila.getAttribute("IdComplementoIgss").toString());
         viewDet.executeQuery();
         viewDet.setWhereClause(null);
         
     }
     
    /**
     * Posiciona en el row seleccionado isSel = true
     */
    public void posicionaSeleccionado(){
        Row []pFilas;
        int vTam; 
        pFilas=this.getAllRowsInRange();
         
        vTam=pFilas.length;
        
        for (int i=0;i<vTam;i++){
          
          if ((Boolean)pFilas[i].getAttribute("isSel")==true){
              this.setCurrentRow(pFilas[i]);
              break;
          }
            
        }     
            
    }      
    
    public void registraModificacionEnDetalle(){
        Row pFila;
        pFila=this.getCurrentRow();
        
        Object fecha = new oracle.jbo.domain.Date().getCurrentDate();
        Calendar calendario = Calendar.getInstance();
        int hora = calendario.get(Calendar.HOUR_OF_DAY);
        int minutos = calendario.get(Calendar.MINUTE);
        int segundos = calendario.get(Calendar.SECOND);
        oracle.jbo.domain.Date fechaHora = new oracle.jbo.domain.Date(fecha.toString()+" "+String.valueOf(hora)+":"+String.valueOf(minutos)+":"+String.valueOf(segundos));
        
        SessionImpl session = (SessionImpl)this.getDBTransaction().getRootApplicationModule().getSession();
        String usuario = session.getUserPrincipalName();
        
        pFila.setAttribute("ModPor",usuario);
        pFila.setAttribute("FechaMod",fechaHora);

    }
}
